
{% extends 'base.html' %}
{% load static %}

{% block title %}–ù–æ–≤–æ—Å—Ç–∏ —Å–µ–≥–æ–¥–Ω—è{% endblock %}

{% block content %}
  <div class="row g-2">
        <!-- –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç -->
        <div class="col-md-7">
            <div class="card border-0 shadow-sm">
                <div class="card-body py-2">
                    <div class="d-flex align-items-center">
                        <span class="badge bg-success me-2">
                            <i class="bi bi-cash"></i>
                        </span>
                        <small class="text-muted me-3">–ö—É—Ä—Å—ã:</small>

                        {% if rate_usd %}
                        <div class="d-flex flex-wrap gap-3">
                            <div class="d-flex align-items-center">
                                <small class="text-muted me-1">USD</small>
                                <span class="badge bg-success bg-opacity-10 text-success border border-success border-opacity-25">
                                    {{ rate_usd }}
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <small class="text-muted me-1">EUR</small>
                                <span class="badge bg-primary bg-opacity-10 text-primary border border-primary border-opacity-25">
                                    {{ rate_eur }}
                                </span>
                            </div>
                            <div class="d-flex align-items-center">
                                <small class="text-muted me-1">RUB</small>
                                <span class="badge bg-warning bg-opacity-10 text-warning border border-warning border-opacity-25">
                                    {{ rate_rub }}
                                </span>
                            </div>
                        </div>
                        {% else %}
                        <span class="text-muted small">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ -->
        <div class="col-md-5">
            <div class="card border-0 shadow-sm">
                <div class="card-body py-2">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="d-flex align-items-center">
                            <span class="badge bg-info me-2">
                                <i class="bi bi-thermometer"></i>
                            </span>
                            <small class="text-muted me-2">–°—Ä–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ –†–ë:</small>

                            {% if t_avg %}
                            <div class="d-flex align-items-center">
                                <span class="fw-bold text-primary me-1">{{ t_avg|floatformat:1 }}¬∞</span>
                                <a href="{% url 'weather' %}"> –°–º–æ—Ç—Ä–µ—Ç—å –ø–æ–≥–æ–¥—É –ø–æ –≥–æ—Ä–æ–¥–∞–º </a>
                            </div>
                            {% else %}
                            <span class="text-muted small">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
<div class="mb-3 d-flex justify-content-between align-items-center flex-wrap">
    <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
    <div class="d-flex flex-wrap">
        <!-- –ö–Ω–æ–ø–∫–∞ "–í—Å–µ" -->
        <a href="{% url 'news' %}" class="btn btn-sm {% if not selected_category %}btn-success{% else %}btn-outline-success{% endif %} me-2 mb-2">
            –í—Å–µ
        </a>
        <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
        {% for category in categories %}
            <a href="?category={{ category.id }}" class="btn btn-sm {% if category.id|stringformat:"s" == selected_category %}btn-success{% else %}btn-outline-success{% endif %} me-2 mb-2">
                {{ category.name }}
            </a>
        {% endfor %}
    </div>
</div>

    <!-- –ü–æ–∏—Å–∫ -->
    <form method="get" class="text-center mb-4">
        <div class="input-group w-50 mx-auto">
            <input type="text" name="q" value="{{ request.GET.q }}" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É ..."
                   class="form-control border-success">
            <button class="btn btn-success" type="submit">üîç –ù–∞–π—Ç–∏</button>
        </div>
    </form>

<!-- –ù–æ–≤–æ—Å—Ç–∏ -->
<div class="row">
    <h1 style="text-align: center;">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h1>

    {% for news_item in news %}
    <div class="news-item">
        <h2 class="news-title">
            <a href="{% url 'news_detail' news_item.id %}">{{ news_item.title }}</a>
        </h2>

        {% if news_item.image_url %}
        <img src="{{ news_item.image_url }}" alt="{{ news_item.title }}" class="news-image">
        {% else %}
        <img src="{% static 'no-image.png' %}" class="img-fluid rounded shadow-sm" alt="–ù–µ—Ç —Ñ–æ—Ç–æ">
        {% endif %}
        üëÅÔ∏è {{ news_item.views }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
        <p class="card-text">{{ news_item.content|truncatewords:25 }}</p>
        <p class="category">
            –ö–∞—Ç–µ–≥–æ—Ä–∏—è:
            {% if news_item.category %}
            {{ news_item.category.name }}
            {% else %}
            –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            {% endif %}
        </p>
        <p class="category">
            –î–∞—Ç–∞: {{ news_item.date_updated|date:"d F Y, H:i" }}
        </p>

    </div>
{% empty %}
    <p style="text-align: center;">–ù–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.</p>
{% endfor %}
</div>
{% endblock %}
